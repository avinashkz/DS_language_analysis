#Pie plots
p <-  x %>% group_by(ax1) %>%
summarise(count = n()) %>% ggplot() +
geom_bar(aes(x = "",
y = count, fill = ax1), alpha = 0.7, color = "black", stat = "identity") +
xlab(responses[i]) +
labs(title = paste("Pie chart for" ,responses[i]), fill = "") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
#Proportion plots
q <- x %>% group_by(ax1) %>% mutate(count = n()) %>%
ggplot(aes(fct_reorder(ax1,count, .desc = TRUE))) +
geom_bar(aes(y = (..count..)/sum(..count..), fill = Class), position = "fill", color = "black", alpha = 0.7) +
xlab(responses[i]) +
labs(title = paste("Proportions for" ,responses[i]), y = "Proportion") +
scale_fill_brewer(palette= "Dark2") +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14))
#Save files
if(n > 3){
ggsave(plot = p,
filename = paste(plot_name,".png",sep = ""),
path = write_path)
ggsave(plot = q + coord_flip(),
filename = paste(plot_name,"_prop.png",sep = ""),
path = write_path)
}
else
{
ggsave(plot = p,
filename = paste(plot_name,".png",sep = ""),
path = write_path)
ggsave(plot = q,
filename = paste(plot_name,"_prop.png",sep = ""),
path = write_path)
}
}
#Read the data
responses <- read.csv(file = "docs/survey_results_clean.csv")
plot_title <- c("Academic Background", "Years of Coding Experience", "Attitude Towards Coding", "First Programming Language",
"R or Python", "Preferred Data Science Task", "Number of Languages Actively Being Used")
#Path to write the file in
write_path <- "docs"
categorical_plots <- function(x, i, responses, plot_name, write_path){
#Function to plot all the categorical variables
colnames(x) <- c("ax1", "Class")
n <- n_distinct(x[,1])
#Pie plots
p <-  x %>% group_by(ax1) %>%
summarise(count = n()) %>% ggplot() +
geom_bar(aes(x = "",
y = count, fill = ax1), alpha = 0.7, color = "black", stat = "identity") +
xlab(responses[i]) +
labs(title = paste("Pie chart for" ,responses[i]), fill = "") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
#Proportion plots
q <- x %>% group_by(ax1) %>% mutate(count = n()) %>%
ggplot(aes(fct_reorder(ax1,count, .desc = TRUE))) +
geom_bar(aes(y = (..count..)/sum(..count..), fill = Class), position = "fill", color = "black", alpha = 0.7) +
xlab(responses[i]) +
labs(title = paste("Proportions for" ,responses[i]), y = "Proportion") +
scale_fill_brewer(palette= "Dark2") +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14))
#Save files
if(n > 3){
ggsave(plot = p,
filename = paste(plot_name,".png",sep = ""),
path = write_path)
ggsave(plot = q + coord_flip(),
filename = paste(plot_name,"_prop.png",sep = ""),
path = write_path)
}
else
{
ggsave(plot = p,
filename = paste(plot_name,".png",sep = ""),
path = write_path)
ggsave(plot = q,
filename = paste(plot_name,"_prop.png",sep = ""),
path = write_path)
}
}
#Plot Bar and Proportion plots for all categorical variables.
for (i in 1:ncol(responses)){
if(i != 5){
categorical_plots(responses[,c(i,5)], i, plot_title, colnames(responses[,i]), write_path)
}
}
paste0("docs/", colnames(responses[,i]),".png")
paste0("docs/", colnames(responses[,1]),".png")
paste0("docs/", colnames(responses)[1],".png")
knitr::opts_chunk$set(echo = TRUE)
responses <- read.csv(file = "docs/survey_results_clean.csv")
p <-  responses[, c(4,5)] %>% group_by(responses[,4]) %>%
summarise(count = n()) %>% ggplot() +
geom_bar(aes(x = "",
y = count, fill = colnames(responses[,4])), alpha = 0.7, color = "black", stat = "identity") +
geom_text(aes(y = count, x = ""), label = count) +
xlab(responses[i]) +
labs(title = paste("Pie chart for" ,responses[i]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
library(dplyr)
library(ggplot2)
p <-  responses[, c(4,5)] %>% group_by(responses[,4]) %>%
summarise(count = n()) %>% ggplot() +
geom_bar(aes(x = "",
y = count, fill = colnames(responses[,4])), alpha = 0.7, color = "black", stat = "identity") +
geom_text(aes(y = count, x = ""), label = count) +
xlab(responses[i]) +
labs(title = paste("Pie chart for" ,responses[i]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
p <-  responses[, c(4,5)] %>% group_by(responses[,4]) %>%
summarise(count = n()) %>% ggplot() +
geom_bar(aes(x = "",
y = count, fill = colnames(responses[,4])), alpha = 0.7, color = "black", stat = "identity") +
geom_text(aes(y = count, x = ""), label = count) +
xlab(responses[i]) +
labs(title = paste("Pie chart for" ,responses[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
p <-  responses[, c(4,5)] %>% group_by(responses[,4]) %>%
summarise(count = n()) %>% ggplot() +
geom_bar(aes(x = "",
y = count, fill = colnames(responses[,4])), alpha = 0.7, color = "black", stat = "identity") +
geom_text(aes(y = count, x = ""), label = count) +
xlab(responses[4]) +
labs(title = paste("Pie chart for" ,responses[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
print(p)
print(p)
y = count, fill = responses[,4], alpha = 0.7, color = "black", stat = "identity") +
p <-  responses[, c(4,5)] %>% group_by(responses[,4]) %>%
p <-  responses[, c(4,5)] %>% group_by(responses[,4]) %>%
p <-  responses[, c(4,5)] %>% group_by(responses[,4]) %>%
p <-  responses[, c(4,5)] %>% group_by(responses[,4]) %>%
p <-  responses[, c(4,5)] %>% group_by(responses[,4]) %>% summarise(count = n()) %>% ggplot() + geom_bar(aes(x = "",
p <-  responses[, c(4,5)] %>% group_by(responses[,4]) %>% summarise(count = n()) %>% ggplot() +
responses[, c(4,5)] %>% group_by(responses[,4]) %>% summarise(count = n()) %>% ggplot() +
View(responses)
View(responses)
knitr::opts_chunk$set(echo = TRUE)
responses <- read.csv(file = "docs/survey_results_clean.csv")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
responses[, c(4,5)] %>% group_by(responses[,4]) %>% summarise(count = n()) %>% ggplot() +
View(responses)
responses[, c(4,5)] %>% group_by(responses[,4])
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>% ggplot() +
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>% ggplot()
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n())
x <- responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n())
ggplot(x) +
ggplot(x) +
geom_bar(aes(x="", y = count, fill = responses[,4], alpha = 0.7, color = "black", stat = "identity")) +
geom_text(aes(y = count, x = ""), label = count) +
xlab(responses[4]) +
labs(title = paste("Pie chart for" ,responses[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
ggplot(x) +
geom_bar(aes(x="", y = count, fill = first_language, alpha = 0.7, color = "black", stat = "identity")) +
geom_text(aes(y = count, x = ""), label = count) +
xlab(responses[4]) +
labs(title = paste("Pie chart for" ,responses[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
ggplot(x) +
geom_bar(aes(x="", y = count, fill = first_language, alpha = 0.7, color = "black", stat = "identity")) +
geom_text(aes(y = count), label = count) +
xlab(responses[4]) +
labs(title = paste("Pie chart for" ,responses[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
ggplot(x) +
geom_col(aes(x="", y = count, fill = first_language, alpha = 0.7, color = "black", stat = "identity")) +
geom_text(aes(y = count), label = count) +
xlab(responses[4]) +
labs(title = paste("Pie chart for" ,responses[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
ggplot(x) +
geom_col(aes(x="", y = count, fill = first_language, alpha = 0.7, color = "black", stat = "identity")) +
geom_text(aes(y = count, x = ""), label = count) +
xlab(responses[4]) +
labs(title = paste("Pie chart for" ,responses[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
ggplot(x) +
geom_bar(aes(x="", y = count, fill = first_language, alpha = 0.7, color = "black")) +
geom_text(aes(y = count, x =""), label = count) +
xlab(responses[4]) +
labs(title = paste("Pie chart for" ,responses[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
ggplot(x) +
geom_histogram(aes(x="", y = count, fill = first_language, alpha = 0.7, color = "black")) +
geom_text(aes(y = count, x =""), label = count) +
xlab(responses[4]) +
labs(title = paste("Pie chart for" ,responses[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
responses <- read.csv(file = "docs/survey_results_clean.csv")
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black"), stat = "identity") +
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
geom_text(aes(y = count, x =""), label = count) +
xlab(responses[4]) +
labs(title = paste("Pie chart for" ,responses[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
geom_text(aes(y = count, x =""), label = count) +
labs(title = paste("Pie chart for" ,responses[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
geom_text(aes(y = count/3 + c(0, cumsum(count)[-length(count)]),
label = percent(count/100)), size=5) +
labs(title = paste("Pie chart for" ,responses[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
library(scales)
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
geom_text(aes(y = count/3 + c(0, cumsum(count)[-length(count)]),
label = percent(count/100)), size=5) +
labs(title = paste("Pie chart for" ,responses[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
geom_text(aes(y = count/3 + c(0, cumsum(count)[-length(count)], x = ""),
label = percent(count/100)), size=5) +
labs(title = paste("Pie chart for" ,responses[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
geom_text(aes(y = count/3 + c(0, cumsum(count)[-length(count)], x = first_language),
label = percent(count/100)), size=5) +
labs(title = paste("Pie chart for" ,responses[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
labs(title = paste("Pie chart for" ,responses[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
labs(title = paste("Pie chart for" ,responses[,4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
labs(title = paste("Pie chart for" ,colnames(responses)[4], fill = "", x="", y="") +
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
labs(title = paste("Pie chart for" ,colnames(responses)[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>%
colnames(responses)[4]
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
labs(title = paste("Pie chart for" , colnames(responses)[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>% mutate(pos = cumsum(count)- count/2)
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>% mutate(pos = cumsum(count)- count/2) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity")
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>% mutate(pos = cumsum(count)- count/2) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
labs(title = paste("Pie chart for" , colnames(responses)[4]), fill = "", x="", y="")
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>% mutate(pos = cumsum(count)- count/2) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
labs(title = paste("Pie chart for" , colnames(responses)[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1")
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>% mutate(pos = cumsum(count)- count/2) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
labs(title = paste("Pie chart for" , colnames(responses)[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0)
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>% mutate(pos = cumsum(count)- count/2) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
labs(title = paste("Pie chart for" , colnames(responses)[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_bw() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>% mutate(pos = cumsum(count)- count/2) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
labs(title = paste("Pie chart for" , colnames(responses)[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_minimal() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>% mutate(pos = cumsum(count)- count/2) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
geom_text(aes(x="", y=pos, label = count), size=10)
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>% mutate(pos = cumsum(count)- count/2) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
geom_text(aes(x="", y=pos, label = count), size=5) +
labs(title = paste("Pie chart for" , colnames(responses)[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_minimal() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>% mutate(pos = cumsum(count)) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
geom_text(aes(x="", y=pos, label = count), size=5) +
labs(title = paste("Pie chart for" , colnames(responses)[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_minimal() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>% mutate(pos = cumsum(count))
responses <- read.csv(file = "docs/survey_results_clean.csv")
responses
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>% mutate(pos = cumsum(count)) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
geom_text(aes(x="", y=pos, label = count), size=5) +
labs(title = paste("Pie chart for" , colnames(responses)[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_minimal() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>% mutate(pos = cumsum(count) + count/2) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
geom_text(aes(x="", y=pos, label = count), size=5) +
labs(title = paste("Pie chart for" , colnames(responses)[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_minimal() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>% mutate(pos = cumsum(count) - count/2) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
geom_text(aes(x="", y=pos, label = count), size=5) +
labs(title = paste("Pie chart for" , colnames(responses)[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_minimal() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>% mutate(pos = cumsum(count) - count/2)
responses[, c(4,5)] %>% group_by(first_language) %>% summarise(count = n()) %>% mutate(pos = cumsum(count) - count/2) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
geom_text(aes(x="", y=pos, label = count), size=5) +
labs(title = paste("Pie chart for" , colnames(responses)[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_minimal() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
responses[, c(4,5)] %>% group_by(first_language) %>% arrange(first_language)
responses[, c(4,5)] %>% group_by(first_language) %>% arrange(first_language) %>%  summarise(count = n())
responses[, c(4,5)] %>% group_by(first_language) %>% arrange(desc(first_language)) %>%  summarise(count = n())
responses[, c(4,5)] %>% group_by(first_language) %>%  summarise(count = n()) %>% arrange(desc(first_language))
responses[, c(4,5)] %>% group_by(first_language) %>%  summarise(count = n()) %>% arrange(desc(first_language)) %>% mutate(pos = cumsum(count) - count/2) %>%
ggplot() +
geom_bar(aes(x="", y = count, fill = first_language), alpha = 0.7, color = "black", stat = "identity") +
geom_text(aes(x="", y=pos, label = count), size=5) +
labs(title = paste("Pie chart for" , colnames(responses)[4]), fill = "", x="", y="") +
scale_fill_brewer(palette = "Set1") +
coord_polar("y", start=0) +
theme_minimal() + theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text.x = element_blank())
getwd()
knitr::opts_chunk$set(echo = TRUE)
![](docs/first_language.png)
View(responses)
